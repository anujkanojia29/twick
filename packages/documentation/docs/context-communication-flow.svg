<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="700" height="400" viewBox="0 0 700 400" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <!-- Gradients -->
    <linearGradient id="uiGradient" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#3b82f6" stop-opacity="1"/>
      <stop offset="1" stop-color="#1d4ed8" stop-opacity="1"/>
    </linearGradient>
    
    <linearGradient id="contextGradient" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#10b981" stop-opacity="1"/>
      <stop offset="1" stop-color="#059669" stop-opacity="1"/>
    </linearGradient>
    
    <linearGradient id="editorGradient" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#f59e0b" stop-opacity="1"/>
      <stop offset="1" stop-color="#d97706" stop-opacity="1"/>
    </linearGradient>
    
    <linearGradient id="storeGradient" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#8b5cf6" stop-opacity="1"/>
      <stop offset="1" stop-color="#7c3aed" stop-opacity="1"/>
    </linearGradient>
    
    <linearGradient id="playerGradient" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#ef4444" stop-opacity="1"/>
      <stop offset="1" stop-color="#dc2626" stop-opacity="1"/>
    </linearGradient>
    
    <!-- Drop shadow filter -->
    <filter id="shadow" x="-0.2" y="-0.2" width="1.4" height="1.4">
      <feDropShadow dx="2" dy="4" stdDeviation="3" flood-color="#000000" flood-opacity="0.2"/>
    </filter>
    
    <!-- Arrow marker -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto" markerUnits="strokeWidth">
      <polygon points="0,0 10,3.5 0,7" fill="#374151"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="700" height="400" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="350" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1f2937">
    Context Communication Flow
  </text>
  
  <!-- Participant Boxes -->
  <!-- UI Component -->
  <g transform="translate(50, 80)">
    <rect x="0" y="0" width="80" height="50" rx="8" fill="url(#uiGradient)" filter="url(#shadow)"/>
    <text x="40" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">UI Component</text>
    <text x="40" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">React Component</text>
  </g>
  
  <!-- TimelineContext -->
  <g transform="translate(170, 80)">
    <rect x="0" y="0" width="100" height="50" rx="8" fill="url(#contextGradient)" filter="url(#shadow)"/>
    <text x="50" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">TimelineContext</text>
    <text x="50" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">State Provider</text>
  </g>
  
  <!-- TimelineEditor -->
  <g transform="translate(290, 80)">
    <rect x="0" y="0" width="80" height="50" rx="8" fill="url(#editorGradient)" filter="url(#shadow)"/>
    <text x="40" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">TimelineEditor</text>
    <text x="40" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Core Orchestrator</text>
  </g>
  
  <!-- TimelineStore -->
  <g transform="translate(410, 80)">
    <rect x="0" y="0" width="80" height="50" rx="8" fill="url(#storeGradient)" filter="url(#shadow)"/>
    <text x="40" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">TimelineStore</text>
    <text x="40" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Data Store</text>
  </g>
  
  <!-- LivePlayerContext -->
  <g transform="translate(510, 80)">
    <rect x="0" y="0" width="110" height="50" rx="8" fill="url(#playerGradient)" filter="url(#shadow)"/>
    <text x="55" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">LivePlayerContext</text>
    <text x="55" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Player State</text>
  </g>
  
  <!-- Lifelines -->
  <line x1="90" y1="130" x2="90" y2="350" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="220" y1="130" x2="220" y2="350" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="330" y1="130" x2="330" y2="350" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="450" y1="130" x2="450" y2="350" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="565" y1="130" x2="565" y2="350" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- Messages -->
  <!-- Step 1: UI -> TimelineEditor -->
  <line x1="90" y1="160" x2="330" y2="160" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="210" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#374151">Execute editor operation</text>
  
  <!-- Step 2: TimelineEditor -> TimelineStore -->
  <line x1="330" y1="190" x2="450" y2="190" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="390" y="185" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#374151">Update timeline store</text>
  
  <!-- Step 3: TimelineEditor -> TimelineContext -->
  <line x1="330" y1="220" x2="220" y2="220" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="275" y="215" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#374151">Timeline state updated</text>
  
  <!-- Step 4: TimelineEditor -> LivePlayerContext -->
  <line x1="330" y1="250" x2="565" y2="250" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="447" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#374151">Update Live Player state</text>
  
  <!-- Step 5: TimelineEditor -> LivePlayerContext -->
  <line x1="330" y1="280" x2="565" y2="280" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="447" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#374151">Player state sync</text>
  
  <!-- Step 6: LivePlayerContext -> UI -->
  <line x1="565" y1="310" x2="90" y2="310" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="327" y="305" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#374151">Re-render with updated state</text>
  
  <!-- Flow Description -->
  <g transform="translate(50, 340)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1f2937">Flow Description:</text>
    <text x="0" y="18" font-family="Arial, sans-serif" font-size="11" fill="#374151">1. UI Component triggers operation → 2. TimelineEditor processes → 3. Store updates → 4. Context notifications → 5. Player sync → 6. UI re-render</text>
  </g>
  
  <!-- Architecture Notes -->
  <g transform="translate(400, 340)">
    <text x="0" y="0" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1f2937">Key Benefits:</text>
    <text x="0" y="18" font-family="Arial, sans-serif" font-size="11" fill="#374151">• Unidirectional data flow</text>
    <text x="0" y="30" font-family="Arial, sans-serif" font-size="11" fill="#374151">• Clear separation of concerns</text>
    <text x="0" y="42" font-family="Arial, sans-serif" font-size="11" fill="#374151">• Predictable state updates</text>
  </g>
</svg>
